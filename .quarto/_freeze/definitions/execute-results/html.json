{
  "hash": "85e901629f6a5add1edd25cf2290ba37",
  "result": {
    "markdown": "---\ntitle: Definitions\ndate: today\n---\n\n# Main functions\n\nWe overall interact with two functions, $\\ell$ and $g$, which are defined as \n\n$$\\ell(t)\\triangleq -\\alpha t + \\beta\\qquad\\text{for some}\\;\\alpha,\\beta > 0$$\n\nand\n\n$$g(t)\\triangleq \\eta\\exp\\left( \\;-\\sigma \\; t\\;\\right)\\qquad\\text{for some}\\; \\eta, \\sigma > 0$$\n\nthese functions serve as a proxy to define a third function, called \"switch\" or $\\mathrm{S}_\\boldsymbol{\\theta}$, which is defined as\n\n$$\\mathrm{S}_\\boldsymbol{\\theta}(t) =\n\\begin{cases}\n\\ell_\\boldsymbol{\\theta}(t)&\\text{if}\\;t\\leq t_s\\\\\ng_\\boldsymbol{\\theta}(t) & \\text{if}\\;t> t_s \n\\end{cases}\n$$\n\nwhere $\\boldsymbol{\\theta}$ is a vector parameter storing all variables of interest:\n\n$$\\boldsymbol{\\theta} \\triangleq \\left(\\alpha, \\beta, \\eta, \\sigma, t_s\\right)$$\n\n# Variables\n\n| Variable | Description |\n| --- | --- |\n| $\\alpha$ | The rate of change of the linear function |\n| $\\beta$ | The initial value of the linear function |\n| $\\eta$ | The amplitude of the exponential function |\n| $\\sigma$ |  The rate of decay of the exponential function |\n| $t_s$ | The time at which the switch function changes from linear to exponential |\n\n# Relationships between the variables\n\nFrom the continuity assumption, we get\n\n$$\\ell(t_s) = g(t_s)$$\n\nand\n\n$$\\ell'(t_s) = g'(t_s)$$\n\nwhich provides for the equations\n\n$$-\\alpha t_s+ \\beta = \\eta \\exp(-\\sigma\\cdot t_s)$$ and \n$$\\alpha = \\sigma\\eta\\exp(-\\sigma\\cdot t_s)$$\n\n## Derivation of key quantities\n\nTo avoid the occasionnal handwriting mistake, we can symbollically solve the arithmetic using symbolic programming:\n\n### Substitutions\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom sympy import *\n\nα, β, σ, η = symbols('α β σ η', positive=True)\n\nt_s, T_L, T_0 = symbols('t_s T_L T_0', positive=True)\n\n\neqns = [\n    -α * t_s+ β - η * exp(- σ * t_s),\n    α - σ * η * exp(-σ * t_s),\n]\ninit_printing()\nsols = solve(eqns, [t_s]).pop()\nsols[0]\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n$\\displaystyle \\log{\\left(\\left(\\frac{η σ}{α}\\right)^{\\frac{1}{σ}} \\right)}$\n:::\n:::\n\n\nWhence from substitution we get\n\n$$-\\alpha t_s + \\beta = \\eta \\exp\\left(-\\sigma\\log\\left(\\left(\\dfrac{\\eta\\sigma}{\\alpha}\\right)^{1/\\sigma}\\right)\\right) = \\eta \\dfrac{\\alpha}{\\eta\\sigma}$$\n\nwhich implies\n\n$$t_s = \\dfrac{\\beta}{\\alpha} - \\dfrac1\\sigma =  \\beta\\alpha^{-1} - \\sigma^{-1}$$\n\n\n### Integration\n\nWe can even solve the intergral symbollically to avoid silly mistakes\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nt = symbols('t')\n\nconds = [\n    (t_s > T_0, True), (t_s < T_L, True),\n    (T_0 < T_L, True), (t < T_L, True),\n    (t > T_0, True)\n]\n\nlS = Piecewise((-α*t+β, True), *conds)\nrS = Piecewise((η * exp(-σ * t), True), *conds)\ntotal = lS.integrate((t,T_0, t_s)).doit() + rS.integrate((t, t_s, T_L)).doit()\nexpand(expand_log(powsimp(total.subs(t_s, β/α- 1/σ))))\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n$\\displaystyle \\frac{T_{0}^{2} α}{2} - T_{0} β - \\frac{α}{2 σ^{2}} + \\frac{e η e^{- \\frac{β σ}{α}}}{σ} - \\frac{η e^{- T_{L} σ}}{σ} + \\frac{β^{2}}{2 α}$\n:::\n:::\n\n\nWhence the integral we care about\n\n\n$$\\int_{T_0}^{T_\\text{L}}\\mathrm{S}_\\boldsymbol{\\theta}(t)\\mathrm{d}t\n\\leq \\mathrm{B}\n\\iff  \\int_{T_0}^{t_s}\\ell_\\boldsymbol{\\theta}(t)\\mathrm{d}t + \\int_{t_s}^{T_\\text{L}}g_\\boldsymbol{\\theta}(t)\\mathrm{d}t \\leq \\mathrm{B}$$\n\nA final simplification is\n$$\\alpha = \\sigma\\eta\\exp(-\\sigma\\beta\\alpha^{-1} + \\sigma\\sigma^{-1} ) = \\sigma\\eta\\exp(1- \\sigma\\beta\\alpha^{-1} ) $$\n\nOur final expression for the cost is\n\n$$\n\\displaystyle \\frac{T_{0}^{2} α}{2} - T_{0} β - \\frac{α}{2 σ^{2}} + \\frac{\\alpha  }{σ^2} - \\frac{η e^{- T_{L} σ}}{σ} + \\frac{β^{2}}{2 α}\n$$\n\n\n### Derivatives\n\nWhat might be of important in scenario is that the acceleration shouldn't be too steep. That means spread the effort enough that we do not need to \"accelerate\" too suddenly. This means the $\\mathrm{L}_2$ norm of the acceletation wrt $t$ of $\\mathrm{S}_\\boldsymbol{\\theta}(t)$ should be low.\n\n$$\\displaystyle\\int_{T_0}^{T_\\text{L}}\\left|\\dfrac{\\partial}{\\partial t^2}\\mathrm{S}_\\boldsymbol{\\theta}(t)\\right|^2\\mathrm{d}t = \\left\\lVert\\dfrac{\\partial}{\\partial t^2}\\mathrm{S}_\\boldsymbol{\\theta}\\right\\rVert \\ll K \\qquad\\text{for some }\\; K > 0$$\n\nSince the linear function has curvature zero, we only care about the $t > t_s$ case\n\n$$\\dfrac{\\partial}{\\partial t^2} \\eta\\exp(-\\sigma\\cdot t) = \\eta\\sigma^2\\exp(-\\sigma\\cdot t)$$\n\nfinally,\n\n$$\n\\begin{aligned}\n\\left\\lVert\\dfrac{\\partial}{\\partial t^2}\\mathrm{S}_\\boldsymbol{\\theta}\\right\\rVert &= \\eta^2\\sigma^4\\displaystyle\\int_{t_s}^{T_\\text{L}}\\exp(-2\\sigma\\cdot t)\\,\\mathrm{d}t \\\\\n& = -\\dfrac12\\sigma^{-1}\\eta^2\\sigma^4\\left[\\exp(-2\\sigma T_\\text{L}) - \\exp(-2\\sigma t_s)\\right]\\\\\n& = -\\dfrac12\\sigma^{-1}\\eta^2\\sigma^4\\left[\\exp(-2\\sigma T_\\text{L}) - \\dfrac{\\alpha^2}{\\eta^2\\sigma^2}\\right] \\\\\n&= -\\dfrac12\\sigma^{-1}\\eta^2\\sigma^4\\exp(-2\\sigma T_\\text{L}) + \\dfrac12 \\eta^2\\sigma\\alpha^2\n\\end{aligned}\n$$\n\n\n## Relationships\n\n| Number | Variables | Expression |\n| --- | --- | --- |\n| 1 | $t_s$ | $-\\frac{1}{\\sigma}\\ln\\left(\\frac{\\alpha}{\\eta\\sigma}\\right)$ |\n| 2 | $\\exp(-\\sigma \\cdot t_s)$ | $\\dfrac{\\alpha}{\\eta\\sigma}$ |\n| 3 | $t_s$ | $\\dfrac{\\eta}{\\sigma}\\exp(-\\sigma \\cdot t_s)$ |\n| 4 | $\\displaystyle\\int_{T_0}^{T_\\text{L}}\\mathrm{S}_\\boldsymbol{\\theta}(t)\\mathrm{d}t$ | $\\frac{T_{0}^{2} α}{2} - T_{0} β - \\frac{α}{2 σ^{2}} + \\frac{\\alpha  }{σ^2} - \\frac{η e^{- T_{L} σ}}{σ} + \\frac{β^{2}}{2 α}$ |\n| 5 | $\\left\\lVert\\dfrac{\\partial}{\\partial t^2}\\mathrm{S}_\\boldsymbol{\\theta}\\right\\rVert$ | $-\\dfrac12\\sigma^{-1}\\eta^2\\sigma^4\\exp(-2\\sigma T_\\text{L}) + \\dfrac12 \\eta^2\\sigma\\alpha^2$ |\n\n",
    "supporting": [
      "definitions_files"
    ],
    "filters": [],
    "includes": {}
  }
}